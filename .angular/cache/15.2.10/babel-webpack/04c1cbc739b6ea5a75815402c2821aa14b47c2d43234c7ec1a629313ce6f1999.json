{"ast":null,"code":"\"use strict\";\n\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NodeModulesEngineHost = exports.NodePackageDoesNotSupportSchematics = void 0;\nconst core_1 = require(\"@angular-devkit/core\");\nconst path_1 = require(\"path\");\nconst export_ref_1 = require(\"./export-ref\");\nconst file_system_engine_host_base_1 = require(\"./file-system-engine-host-base\");\nconst file_system_utility_1 = require(\"./file-system-utility\");\nclass NodePackageDoesNotSupportSchematics extends core_1.BaseException {\n  constructor(name) {\n    super(`Package ${JSON.stringify(name)} was found but does not support schematics.`);\n  }\n}\nexports.NodePackageDoesNotSupportSchematics = NodePackageDoesNotSupportSchematics;\n/**\n * A simple EngineHost that uses NodeModules to resolve collections.\n */\nclass NodeModulesEngineHost extends file_system_engine_host_base_1.FileSystemEngineHostBase {\n  constructor(paths) {\n    super();\n    this.paths = paths;\n  }\n  resolve(name, requester, references = new Set()) {\n    if (requester) {\n      if (references.has(requester)) {\n        references.add(requester);\n        throw new Error('Circular schematic reference detected: ' + JSON.stringify(Array.from(references)));\n      } else {\n        references.add(requester);\n      }\n    }\n    const relativeBase = requester ? (0, path_1.dirname)(requester) : process.cwd();\n    let collectionPath = undefined;\n    if (name.startsWith('.')) {\n      name = (0, path_1.resolve)(relativeBase, name);\n    }\n    const resolveOptions = {\n      paths: requester ? [(0, path_1.dirname)(requester), ...(this.paths || [])] : this.paths\n    };\n    // Try to resolve as a package\n    try {\n      const packageJsonPath = require.resolve((0, path_1.join)(name, 'package.json'), resolveOptions);\n      const {\n        schematics\n      } = require(packageJsonPath);\n      if (!schematics || typeof schematics !== 'string') {\n        throw new NodePackageDoesNotSupportSchematics(name);\n      }\n      collectionPath = this.resolve(schematics, packageJsonPath, references);\n    } catch (e) {\n      if (e.code !== 'MODULE_NOT_FOUND') {\n        throw e;\n      }\n    }\n    // If not a package, try to resolve as a file\n    if (!collectionPath) {\n      try {\n        collectionPath = require.resolve(name, resolveOptions);\n      } catch (e) {\n        if (e.code !== 'MODULE_NOT_FOUND') {\n          throw e;\n        }\n      }\n    }\n    // If not a package or a file, error\n    if (!collectionPath) {\n      throw new file_system_engine_host_base_1.CollectionCannotBeResolvedException(name);\n    }\n    return collectionPath;\n  }\n  _resolveCollectionPath(name, requester) {\n    const collectionPath = this.resolve(name, requester);\n    (0, file_system_utility_1.readJsonFile)(collectionPath);\n    return collectionPath;\n  }\n  _resolveReferenceString(refString, parentPath, collectionDescription) {\n    const ref = new export_ref_1.ExportStringRef(refString, parentPath);\n    if (!ref.ref) {\n      return null;\n    }\n    return {\n      ref: ref.ref,\n      path: ref.module\n    };\n  }\n  _transformCollectionDescription(name, desc) {\n    if (!desc.schematics || typeof desc.schematics != 'object') {\n      throw new file_system_engine_host_base_1.CollectionMissingSchematicsMapException(name);\n    }\n    return {\n      ...desc,\n      name\n    };\n  }\n  _transformSchematicDescription(name, _collection, desc) {\n    if (!desc.factoryFn || !desc.path || !desc.description) {\n      throw new file_system_engine_host_base_1.SchematicMissingFieldsException(name);\n    }\n    return desc;\n  }\n}\nexports.NodeModulesEngineHost = NodeModulesEngineHost;","map":{"version":3,"names":["Object","defineProperty","exports","value","NodeModulesEngineHost","NodePackageDoesNotSupportSchematics","core_1","require","path_1","export_ref_1","file_system_engine_host_base_1","file_system_utility_1","BaseException","constructor","name","JSON","stringify","FileSystemEngineHostBase","paths","resolve","requester","references","Set","has","add","Error","Array","from","relativeBase","dirname","process","cwd","collectionPath","undefined","startsWith","resolveOptions","packageJsonPath","join","schematics","e","code","CollectionCannotBeResolvedException","_resolveCollectionPath","readJsonFile","_resolveReferenceString","refString","parentPath","collectionDescription","ref","ExportStringRef","path","module","_transformCollectionDescription","desc","CollectionMissingSchematicsMapException","_transformSchematicDescription","_collection","factoryFn","description","SchematicMissingFieldsException"],"sources":["I:/Angular/angular-blog/node_modules/@angular-devkit/schematics/tools/node-module-engine-host.js"],"sourcesContent":["\"use strict\";\n/**\n * @license\n * Copyright Google LLC All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.NodeModulesEngineHost = exports.NodePackageDoesNotSupportSchematics = void 0;\nconst core_1 = require(\"@angular-devkit/core\");\nconst path_1 = require(\"path\");\nconst export_ref_1 = require(\"./export-ref\");\nconst file_system_engine_host_base_1 = require(\"./file-system-engine-host-base\");\nconst file_system_utility_1 = require(\"./file-system-utility\");\nclass NodePackageDoesNotSupportSchematics extends core_1.BaseException {\n    constructor(name) {\n        super(`Package ${JSON.stringify(name)} was found but does not support schematics.`);\n    }\n}\nexports.NodePackageDoesNotSupportSchematics = NodePackageDoesNotSupportSchematics;\n/**\n * A simple EngineHost that uses NodeModules to resolve collections.\n */\nclass NodeModulesEngineHost extends file_system_engine_host_base_1.FileSystemEngineHostBase {\n    constructor(paths) {\n        super();\n        this.paths = paths;\n    }\n    resolve(name, requester, references = new Set()) {\n        if (requester) {\n            if (references.has(requester)) {\n                references.add(requester);\n                throw new Error('Circular schematic reference detected: ' + JSON.stringify(Array.from(references)));\n            }\n            else {\n                references.add(requester);\n            }\n        }\n        const relativeBase = requester ? (0, path_1.dirname)(requester) : process.cwd();\n        let collectionPath = undefined;\n        if (name.startsWith('.')) {\n            name = (0, path_1.resolve)(relativeBase, name);\n        }\n        const resolveOptions = {\n            paths: requester ? [(0, path_1.dirname)(requester), ...(this.paths || [])] : this.paths,\n        };\n        // Try to resolve as a package\n        try {\n            const packageJsonPath = require.resolve((0, path_1.join)(name, 'package.json'), resolveOptions);\n            const { schematics } = require(packageJsonPath);\n            if (!schematics || typeof schematics !== 'string') {\n                throw new NodePackageDoesNotSupportSchematics(name);\n            }\n            collectionPath = this.resolve(schematics, packageJsonPath, references);\n        }\n        catch (e) {\n            if (e.code !== 'MODULE_NOT_FOUND') {\n                throw e;\n            }\n        }\n        // If not a package, try to resolve as a file\n        if (!collectionPath) {\n            try {\n                collectionPath = require.resolve(name, resolveOptions);\n            }\n            catch (e) {\n                if (e.code !== 'MODULE_NOT_FOUND') {\n                    throw e;\n                }\n            }\n        }\n        // If not a package or a file, error\n        if (!collectionPath) {\n            throw new file_system_engine_host_base_1.CollectionCannotBeResolvedException(name);\n        }\n        return collectionPath;\n    }\n    _resolveCollectionPath(name, requester) {\n        const collectionPath = this.resolve(name, requester);\n        (0, file_system_utility_1.readJsonFile)(collectionPath);\n        return collectionPath;\n    }\n    _resolveReferenceString(refString, parentPath, collectionDescription) {\n        const ref = new export_ref_1.ExportStringRef(refString, parentPath);\n        if (!ref.ref) {\n            return null;\n        }\n        return { ref: ref.ref, path: ref.module };\n    }\n    _transformCollectionDescription(name, desc) {\n        if (!desc.schematics || typeof desc.schematics != 'object') {\n            throw new file_system_engine_host_base_1.CollectionMissingSchematicsMapException(name);\n        }\n        return {\n            ...desc,\n            name,\n        };\n    }\n    _transformSchematicDescription(name, _collection, desc) {\n        if (!desc.factoryFn || !desc.path || !desc.description) {\n            throw new file_system_engine_host_base_1.SchematicMissingFieldsException(name);\n        }\n        return desc;\n    }\n}\nexports.NodeModulesEngineHost = NodeModulesEngineHost;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}