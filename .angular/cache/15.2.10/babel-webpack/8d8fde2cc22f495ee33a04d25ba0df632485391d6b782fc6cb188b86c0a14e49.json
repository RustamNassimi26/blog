{"ast":null,"code":"const semver = require('semver');\nconst checkEngine = (target, npmVer, nodeVer, force = false) => {\n  const nodev = force ? null : nodeVer;\n  const eng = target.engines;\n  const opt = {\n    includePrerelease: true\n  };\n  if (!eng) {\n    return;\n  }\n  const nodeFail = nodev && eng.node && !semver.satisfies(nodev, eng.node, opt);\n  const npmFail = npmVer && eng.npm && !semver.satisfies(npmVer, eng.npm, opt);\n  if (nodeFail || npmFail) {\n    throw Object.assign(new Error('Unsupported engine'), {\n      pkgid: target._id,\n      current: {\n        node: nodeVer,\n        npm: npmVer\n      },\n      required: eng,\n      code: 'EBADENGINE'\n    });\n  }\n};\nconst isMusl = file => file.includes('libc.musl-') || file.includes('ld-musl-');\nconst checkPlatform = (target, force = false, environment = {}) => {\n  if (force) {\n    return;\n  }\n  const platform = environment.os || process.platform;\n  const arch = environment.cpu || process.arch;\n  const osOk = target.os ? checkList(platform, target.os) : true;\n  const cpuOk = target.cpu ? checkList(arch, target.cpu) : true;\n  let libcOk = true;\n  let libcFamily = null;\n  if (target.libc) {\n    // libc checks only work in linux, any value is a failure if we aren't\n    if (environment.libc) {\n      libcOk = checkList(environment.libc, target.libc);\n    } else if (platform !== 'linux') {\n      libcOk = false;\n    } else {\n      const report = process.report.getReport();\n      if (report.header?.glibcVersionRuntime) {\n        libcFamily = 'glibc';\n      } else if (Array.isArray(report.sharedObjects) && report.sharedObjects.some(isMusl)) {\n        libcFamily = 'musl';\n      }\n      libcOk = libcFamily ? checkList(libcFamily, target.libc) : false;\n    }\n  }\n  if (!osOk || !cpuOk || !libcOk) {\n    throw Object.assign(new Error('Unsupported platform'), {\n      pkgid: target._id,\n      current: {\n        os: platform,\n        cpu: arch,\n        libc: libcFamily\n      },\n      required: {\n        os: target.os,\n        cpu: target.cpu,\n        libc: target.libc\n      },\n      code: 'EBADPLATFORM'\n    });\n  }\n};\nconst checkList = (value, list) => {\n  if (typeof list === 'string') {\n    list = [list];\n  }\n  if (list.length === 1 && list[0] === 'any') {\n    return true;\n  }\n  // match none of the negated values, and at least one of the\n  // non-negated values, if any are present.\n  let negated = 0;\n  let match = false;\n  for (const entry of list) {\n    const negate = entry.charAt(0) === '!';\n    const test = negate ? entry.slice(1) : entry;\n    if (negate) {\n      negated++;\n      if (value === test) {\n        return false;\n      }\n    } else {\n      match = match || value === test;\n    }\n  }\n  return match || negated === list.length;\n};\nmodule.exports = {\n  checkEngine,\n  checkPlatform\n};","map":{"version":3,"names":["semver","require","checkEngine","target","npmVer","nodeVer","force","nodev","eng","engines","opt","includePrerelease","nodeFail","node","satisfies","npmFail","npm","Object","assign","Error","pkgid","_id","current","required","code","isMusl","file","includes","checkPlatform","environment","platform","os","process","arch","cpu","osOk","checkList","cpuOk","libcOk","libcFamily","libc","report","getReport","header","glibcVersionRuntime","Array","isArray","sharedObjects","some","value","list","length","negated","match","entry","negate","charAt","test","slice","module","exports"],"sources":["I:/Angular/angular-blog/node_modules/npm-install-checks/lib/index.js"],"sourcesContent":["const semver = require('semver')\n\nconst checkEngine = (target, npmVer, nodeVer, force = false) => {\n  const nodev = force ? null : nodeVer\n  const eng = target.engines\n  const opt = { includePrerelease: true }\n  if (!eng) {\n    return\n  }\n\n  const nodeFail = nodev && eng.node && !semver.satisfies(nodev, eng.node, opt)\n  const npmFail = npmVer && eng.npm && !semver.satisfies(npmVer, eng.npm, opt)\n  if (nodeFail || npmFail) {\n    throw Object.assign(new Error('Unsupported engine'), {\n      pkgid: target._id,\n      current: { node: nodeVer, npm: npmVer },\n      required: eng,\n      code: 'EBADENGINE',\n    })\n  }\n}\n\nconst isMusl = (file) => file.includes('libc.musl-') || file.includes('ld-musl-')\n\nconst checkPlatform = (target, force = false, environment = {}) => {\n  if (force) {\n    return\n  }\n\n  const platform = environment.os || process.platform\n  const arch = environment.cpu || process.arch\n  const osOk = target.os ? checkList(platform, target.os) : true\n  const cpuOk = target.cpu ? checkList(arch, target.cpu) : true\n\n  let libcOk = true\n  let libcFamily = null\n  if (target.libc) {\n    // libc checks only work in linux, any value is a failure if we aren't\n    if (environment.libc) {\n      libcOk = checkList(environment.libc, target.libc)\n    } else if (platform !== 'linux') {\n      libcOk = false\n    } else {\n      const report = process.report.getReport()\n      if (report.header?.glibcVersionRuntime) {\n        libcFamily = 'glibc'\n      } else if (Array.isArray(report.sharedObjects) && report.sharedObjects.some(isMusl)) {\n        libcFamily = 'musl'\n      }\n      libcOk = libcFamily ? checkList(libcFamily, target.libc) : false\n    }\n  }\n\n  if (!osOk || !cpuOk || !libcOk) {\n    throw Object.assign(new Error('Unsupported platform'), {\n      pkgid: target._id,\n      current: {\n        os: platform,\n        cpu: arch,\n        libc: libcFamily,\n      },\n      required: {\n        os: target.os,\n        cpu: target.cpu,\n        libc: target.libc,\n      },\n      code: 'EBADPLATFORM',\n    })\n  }\n}\n\nconst checkList = (value, list) => {\n  if (typeof list === 'string') {\n    list = [list]\n  }\n  if (list.length === 1 && list[0] === 'any') {\n    return true\n  }\n  // match none of the negated values, and at least one of the\n  // non-negated values, if any are present.\n  let negated = 0\n  let match = false\n  for (const entry of list) {\n    const negate = entry.charAt(0) === '!'\n    const test = negate ? entry.slice(1) : entry\n    if (negate) {\n      negated++\n      if (value === test) {\n        return false\n      }\n    } else {\n      match = match || value === test\n    }\n  }\n  return match || negated === list.length\n}\n\nmodule.exports = {\n  checkEngine,\n  checkPlatform,\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}